% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils-quality_checks.R
\name{add_outlier5std_column}
\alias{add_outlier5std_column}
\title{Add Outlier Flags Based on 5-MAD Bounds}
\usage{
add_outlier5std_column(.data, indicators, group_by = "district")
}
\arguments{
\item{.data}{A \code{cd_data} tibble containing health indicator data.}

\item{indicators}{A character vector specifying the names of the indicator
columns to analyze for outliers.}

\item{group_by}{A character string or vector specifying the column(s) to group
by when calculating the median and MAD (default is \code{'district'}).}
}
\value{
A tibble with additional columns for each indicator, named
\verb{\{indicator\}_outlier5std}, containing a value of \code{1} if the observation is
an outlier and \code{0} otherwise.
}
\description{
\code{add_outlier5std_column} calculates and appends outlier flags for specified
indicators in a dataset. An outlier is defined as a value falling outside the
range defined by the median Â± 5 times the Median Absolute Deviation (MAD).
This method is applied on a per-group basis, allowing flexibility for grouping
by columns like \code{district}.
}
\details{
\itemize{
\item \strong{Median and MAD Calculation}:
For each indicator, the median and MAD are calculated using data from years
prior to the most recent year in the dataset.
The last year is excluded to prevent potential contamination of the baseline
statistics.
\item \strong{Outlier Definition}:
A value is flagged as an outlier if it falls outside the range:
[
\text{Lower Bound} = \text{median} - 5 \times \text{MAD}, \quad
\text{Upper Bound} = \text{median} + 5 \times \text{MAD}
]
\item \strong{Grouping}:
Calculations are performed separately for each group specified by the
\code{group_by} parameter.
\item \strong{Generated Columns}:
For each indicator, the function generates an outlier flag column named
\verb{\{indicator\}_outlier5std}. The column contains \code{1} if the value is an outlier
and \code{0} otherwise.
}
}
\examples{
# Example dataset
data <- tibble(
  district = rep(c('District A', 'District B'), each = 5),
  year = c(2018:2022, 2018:2022),
  indicator1 = c(10, 12, 13, 50, 14, 9, 11, 10, 15, 12)
)

# Add outlier flags for 'indicator1'
flagged_data <- add_outlier5std_column(data, indicators = 'indicator1',
                                       group_by = 'district')

}
\seealso{
\code{\link[=add_mad_med_columns]{add_mad_med_columns()}} for computing and appending the median and MAD columns.
}
