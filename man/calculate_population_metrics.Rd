% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calculate_population_metrics.R
\name{calculate_population_metrics}
\alias{calculate_population_metrics}
\title{Compute Demographic Denominators and Indicators}
\usage{
calculate_population_metrics(.data, country_name)
}
\arguments{
\item{.data}{A data of type \code{cd_data}.}

\item{country_name}{A scalar string specifying the name of the country for which to
calculate demographic indicators.}
}
\value{
A tibble containing merged data from DHIS-2 and UN sources with calculated
demographic totals, percentages, growth rates, and adjusted crude death rate.
}
\description{
This function calculates population totals, demographic indicators, and growth rates
for a specified country by merging DHIS-2 data and UN population estimates.
}
\details{
The function performs the following steps:
\enumerate{
\item \strong{Prepare DHIS-2 Data}:
\itemize{
\item Selects key demographic columns from DHIS-2 data and renames them for consistency.
\item Adds a \code{country} column set to \code{country_name}.
\item Filters to keep only the first row for each unique combination of \code{district},
\code{adminlevel_1}, and \code{year}.
}
\item \strong{Prepare UN Data}:
\itemize{
\item Filters the UN estimates to include only records for \code{country_name} and years
between 2019 and 2023.
\item Renames columns in the UN data to add a \code{un_} prefix, distinguishing them
from DHIS-2 variables.
}
\item \strong{Merge and Calculate Totals for DHIS-2 Data}:
\itemize{
\item Merges \code{dhis_data} and \code{un_data} by \code{country} and \code{year}.
\item Calculates yearly totals for selected DHIS-2 variables, scaling by dividing by 1,000.
}
\item \strong{Calculate Demographic Indicators}:
\itemize{
\item Calculates demographic percentages and crude birth/death rates for both UN and
DHIS-2 data.
}
\item \strong{Set National Flag and Calculate Population Growth}:
\itemize{
\item Flags the first row of each \code{year} as \code{national} to identify year-level aggregate rows.
\item Calculates \code{totpopgrowth} as the logarithmic year-over-year growth rate
for rows where \code{national == 1}.
}
\item \strong{Calculate Adjusted Crude Death Rate}:
\itemize{
\item Adjusts the crude birth rate (\code{totcbr_dhis2}) based on the calculated growth rate
to yield \code{totcdr_dhis2}.
}
\item \strong{Generate Ratios}:
}
}
\examples{
\dontrun{
  # Assuming `dhis2_data` and `un_data` are preloaded dataframes:
  calculate_population_metrics(
    .data = list(merged_data = dhis2_data),
    country_name = "Kenya"
  )
}

}
